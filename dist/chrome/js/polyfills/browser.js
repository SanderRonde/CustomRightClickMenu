var BrowserAPINS,__extends=this&&this.__extends||function(){var r=function(e,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(e,n)};return function(e,n){function t(){this.constructor=e}r(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(i,u,s,a){return new(s||(s=Promise))(function(e,n){function t(e){try{o(a.next(e))}catch(e){n(e)}}function r(e){try{o(a.throw(e))}catch(e){n(e)}}function o(n){n.done?e(n.value):new s(function(e){e(n.value)}).then(t,r)}o((a=a.apply(i,u||[])).next())})},__generator=this&&this.__generator||function(t,r){var o,i,u,e,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return e={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(u=2&n[0]?i.return:n[0]?i.throw||((u=i.return)&&u.call(i),0):i.next)&&!(u=u.call(i,n[1])).done)return u;switch(i=0,u&&(n=[2&n[0],u.value]),n[0]){case 0:case 1:u=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(u=0<(u=s.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3])){s.label=n[1];break}if(6===n[0]&&s.label<u[1]){s.label=u[1],u=n;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(n);break}u[2]&&s.ops.pop(),s.trys.pop();continue}n=r.call(t,s)}catch(e){n=[6,e],i=0}finally{o=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}};if(function(o){var e=window,a=e.StyleMedia?e.browser:e.chrome;function i(e){return!!a.runtime.lastError&&(e(a.runtime.lastError),!0)}var c=function(i){function e(e,n){var t=e.message,r=n.stack,o=i.call(this,t)||this;return o.stack=r,o.message=t,o}return __extends(e,i),e}(Error);function s(s){return new Promise(function(e,n){var t,r,o,i,u;s((t=new Error,o=(r={resolve:e,reject:n}).resolve,i=r.reject,(u=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];a.runtime.lastError?i(new c(a.runtime.lastError,t)):o(e[0])}).__resolve=o,u.__reject=i,u.__stack=t,u))})}function n(r){return{set:function(n){return s(function(e){a.storage[r].set(n,e)})},remove:function(e){return s(function(t){Array.isArray(e)?Promise.all(e.map(function(n){return new Promise(function(e){a.storage[r].remove(n,function(){i(t.__reject)||e(null)})})})).then(t):a.storage[r].remove(e,t)})},clear:function(){return s(function(e){a.storage[r].clear(e)})}}}var t="browser"in window,r="chrome"in window;function u(e){if("browser"===e)return t;if("chrome"===e)return r;if("undefined"==typeof location||void 0===location.host)return!1;throw new Error("Unsupported browser API support queried")}o.isBrowserAPISupported=u;var l=null;function f(){return l||(l=function(){var e=window,n=!!e.opr&&!!e.opr.addons||!!e.opera||0<=navigator.userAgent.indexOf(" OPR/");if(void 0!==e.InstallTrigger)return"firefox";if(e.StyleMedia)return"edge";if(!n&&u("chrome"))return"chrome";if(n)return"opera";if("undefined"==typeof location||void 0===location.host)return"node";throw new Error("Unsupported browser")}())}function d(e,n,t){for(var r=0;r<e.length;r++){var o=e[r],i=o.id,u=o.children;if(i+""==n+"")return t(o,r,e),!0;if(u&&d(u,n,t))return!0}return!1}o.getBrowser=f,o.getSrc=function(){return a};var g=!1;function w(){p._lastSpecialCall=null,p._currentContextMenu=[],p._activeTabs=[],p._executedScripts=[],p._fakeTabs={},p._activatedBackgroundPages=[],p._tabUpdateListeners=[]}o.resetLogData=w,o.enableLogging=function(){g||w(),g=!0},o.isLoggingEnabled=function(){return g},o.disableLogging=function(){g=!1,p._lastSpecialCall=null,p._currentContextMenu=null,p._activeTabs=null,p._executedScripts=null,p._fakeTabs=null,p._activatedBackgroundPages=null,p._tabUpdateListeners=null};var p={_lastSpecialCall:null,_currentContextMenu:null,_activeTabs:null,_executedScripts:null,_fakeTabs:null,_activatedBackgroundPages:null,_tabUpdateListeners:null,_clearExecutedScripts:function(){for(;p._executedScripts.pop(););}};function _(){return a.downloads?{download:function(n){return g&&(p._lastSpecialCall={api:"downloads.download",args:[n]}),s(function(e){a.downloads.download(n,e)})}}:void 0}o.getTestData=function(){if(-1===location.href.indexOf("backgroun")||-1<a.runtime.getManifest().short_name.indexOf("dev"))return p},o.getDownloadAPI=_,o.polyfill=a?{commands:a.commands?{getAll:function(){return s(function(e){a.commands.getAll(e)})},onCommand:a.commands.onCommand}:void 0,contextMenus:a.contextMenus?{create:function(e,n){var t=a.contextMenus.create(e,function(){n&&(a.runtime.lastError?(o.polyfill.runtime.lastError=a.runtime.lastError.message,n(),o.polyfill.runtime.lastError=null):n())}),r={id:t,createProperties:e,currentProperties:e,children:[]};return g&&(e.parentId?d(p._currentContextMenu,e.parentId,function(e){e.children.push(r)}):p._currentContextMenu.push(r)),Promise.resolve(t)},update:function(n,r){return g&&d(p._currentContextMenu,n,function(e){var n=e.currentProperties;for(var t in r)n[t]=r[t]}),s(function(e){a.contextMenus.update(n+"",r,function(){a.runtime.lastError?a.contextMenus.update(~~n,r,e):e()})})},remove:function(n){return g&&d(p._currentContextMenu,n,function(e,n,t){t.splice(n,1)}),s(function(e){a.contextMenus.remove(n+"",function(){a.runtime.lastError?a.contextMenus.remove(~~n,e):e()})})},removeAll:function(){if(g)for(;p._currentContextMenu.length;)p._currentContextMenu.pop();return s(function(e){var n=a.contextMenus.removeAll(function(){"edge"===f()&&a.runtime.lastError&&e.__resolve(void 0),a.runtime.lastError?e.__reject(new c(a.runtime.lastError,e.__stack)):e.__resolve(void 0)});n&&"undefined"!=typeof window&&window.Promise&&n instanceof window.Promise&&n.then(e.__resolve,e.__reject)})}}:void 0,downloads:_(),extension:a.extension?{isAllowedFileSchemeAccess:function(){return s(function(e){a.extension.isAllowedFileSchemeAccess(e)})}}:void 0,i18n:a.i18n?{getAcceptLanguages:function(){return s(function(e){a.i18n.getAcceptLanguages(e)})},getMessage:function(e,n){return a.i18n.getMessage(e,n)},getUILanguage:function(){return a.i18n.getUILanguage()}}:void 0,notifications:a.notifications?{onClicked:a.notifications.onClicked,onClosed:a.notifications.onClosed}:void 0,permissions:a.permissions?{contains:function(n){return s(function(e){a.permissions.contains(n,e)})},getAll:function(){return s(function(e){a.permissions.getAll(e)})},request:function(n){return s(function(e){a.permissions.request(n,e)})},remove:function(n){return s(function(e){a.permissions.remove(n,e)})}}:void 0,runtime:a.runtime?{connect:function(e,n){return n?a.runtime.connect(e,n):e?a.runtime.connect(e):a.runtime.connect()},getBackgroundPage:function(){return s(function(e){a.runtime.getBackgroundPage(e)})},getManifest:function(){return Promise.resolve(a.runtime.getManifest())},getURL:function(e){return a.runtime.getURL(e)},getPlatformInfo:function(){return s(function(e){a.runtime.getPlatformInfo(e)})},openOptionsPage:function(){return s(function(e){"edge"===o.getBrowser()?o.polyfill.tabs.create({url:o.polyfill.runtime.getURL("html/options.html")}).then(function(){e()}):a.runtime.openOptionsPage(e)})},reload:function(){return Promise.resolve(a.runtime.reload())},sendMessage:function(n,t,r){return s(function(e){r?a.runtime.sendMessage(n,t,r,e):t?a.runtime.sendMessage(n,t,e):a.runtime.sendMessage(n,e)})},onInstalled:a.runtime.onInstalled,onConnectExternal:a.runtime.onConnectExternal,onConnect:a.runtime.onConnect,onMessage:a.runtime.onMessage,lastError:null,id:a.runtime.id}:void 0,storage:a.storage?{local:__assign({},n("local"),{get:function(n){return s(function(e){n?a.storage.local.get(n,e):a.storage.local.get(e)})}}),sync:__assign({},n("sync"),{get:function(n){return s(function(e){n?a.storage.sync.get(n,e):a.storage.sync.get(e)})}}),onChanged:a.storage.onChanged}:void 0,tabs:a.tabs?{create:function(r){return s(function(t){a.tabs.create(r,function(e){var n=e.id;g&&p._activeTabs.push({type:"create",data:r,id:n}),t(e)})})},get:function(n){return s(function(e){a.tabs.get(n,e)})},getCurrent:function(){return s(function(e){a.tabs.getCurrent(e)})},captureVisibleTab:function(n,t){return s(function(e){t?a.tabs.captureVisibleTab(n,t,e):n?a.tabs.captureVisibleTab(n,e):a.tabs.captureVisibleTab(e)})},update:function(r,o){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return[2,s(function(n){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(e){return o?a.tabs.update(r,o,n):a.tabs.update(r,n),g&&p._activeTabs.push({type:"create",data:"number"==typeof r?o:r,id:"number"==typeof r?r:void 0}),[2]})})})]})})},query:function(n){return s(function(e){a.tabs.query(n,e)})},executeScript:function(i,u){var e=this;return s(function(o){return __awaiter(e,void 0,void 0,function(){var n,t,r;return __generator(this,function(e){switch(e.label){case 0:return u?a.tabs.executeScript(i,u,o):a.tabs.executeScript(i,o),(n="number"==typeof i?u:i).code?(t=void 0,"number"!=typeof i?[3,1]:(t=i,[3,3])):[3,4];case 1:return[4,browserAPI.tabs.getCurrent()];case 2:(r=e.sent())&&(t=r.id),e.label=3;case 3:g&&p._executedScripts.push({id:t,code:n.code}),e.label=4;case 4:return[2]}})})})},sendMessage:function(r,o,e){return s(function(e){var n=e.__resolve,t=e.__reject;a.tabs.sendMessage(r,o,function(e){i(t)||n(e)})})},onUpdated:a.tabs.onUpdated,onRemoved:a.tabs.onRemoved,onHighlighted:a.tabs.onHighlighted}:void 0,webRequest:a.webRequest?{onBeforeRequest:a.webRequest.onBeforeRequest}:void 0}:{}}(BrowserAPINS||(BrowserAPINS={})),window.BrowserAPIInstances=window.BrowserAPIInstances||[],window.BrowserAPIInstances.push(BrowserAPINS),!window.browserAPI||window.__isVirtual){window.BrowserAPINS=window.BrowserAPI=BrowserAPINS,window.browserAPI="edge"!==BrowserAPINS.getBrowser()&&window.browser?window.browser:__assign({},BrowserAPINS.polyfill,{__isProxied:!0});var menusBrowserAPI=window.browserAPI;menusBrowserAPI.contextMenus?menusBrowserAPI.menus||(menusBrowserAPI.menus=menusBrowserAPI.contextMenus):menusBrowserAPI.contextMenus=menusBrowserAPI.menus}var BrowserAPI=window.BrowserAPINS,browserAPI=window.browserAPI;